apply plugin: 'java'
apply plugin: 'application'
// apply plugin: 'eclipse'

repositories {
    jcenter()
}

dependencies {
   compile 'args4j:args4j:2.33'
 compile files('myutils.jar')
  compile 'org.json:json:20180130'
  
}
 
/*
version = 1.02
sourceCompatibility = JavaVersion.VERSION_1_8 
targetCompatibility = JavaVersion.VERSION_1_8

*/
 
mainClassName = 'Main'

ext.appdir = file("${System.env.SAM_PROGRAMS}\\${file('.').name.toLowerCase()}\\app")

run {
    workingDir installDist.destinationDir.parent
}

task install(type: Copy, dependsOn:installDist) {
  from file(new File(installDist.destinationDir, 'lib'))
  into appdir
  
  doLast {
     new File(appdir, 'run.cmd').text = """
  @echo off
  setlocal
   
  java %JAVA_OPTS% -cp \"%~dp0${String.join(';%~dp0', new File(installDist.destinationDir, 'lib').list())}\" ${mainClassName} %*
  
  """.stripIndent()
  } 
}

jar {
  exclude '*.fxgraph'
}

defaultTasks 'install'

